<% include ../partials/header %>

<h1>project show page</h1>
<div class="container">
   
        <%= JSON.stringify(result) %>
         <div class="container">
        <% team.rows.forEach(function(row){ %>
            <li><a href="/student/<%= row.usn %>"><%= row.usn %></a>and average total = <%= row.marks %></li>
        <% }) %>
    </div>
    <div class="segment">
        <% for(let member of team.rows){ %>
            <% for(let mark of marks.rows){ %>
                <% if(member.usn== mark.usn){ %>
                <li><%= mark.usn %> and <%= mark.total %> </li>
            <% } } }%>
    </div>
</div>

<div class="container">
    <table class="ui sortable celled table">
  <thead>
    <tr>
      <th>usn</th>
      <th>demonstration</th>
      <th>viva</th>
      <th>report</th>
      <th>total</th>
      <th>valued_by</th>
    </tr>
  </thead>
  <tbody>
    
    <% for (let row of marks.rows) { %>
  <tr>
      <td><%= row["usn"] %>
        <% if(currentUser.type == "teacher" && currentUser.id != row.valued_by) { %>
          <button>add</button>
          <form action="/marks/<%= result.pid %>" method='post'>
            <div class="ui form">
              <div class="inline fields">
                <div class="field">
                  <input type="hidden" name="pid" value="<%= result.pid %>" disabled>
                </div>
                <div class="field">
                  <input type="text" name="usn" value="<%= row.usn %>" disabled>
                </div>
                <div class="field">
                  <input type="number" name="demo" placeholder="demonstration" min="0" max="15">
                </div>
                <div class="field">
                  <input type="number" name="viva"  placeholder="viva" min="0" max="5">
                </div>
                <div class="field">
                  <input type="number" name="report" placeholder="report" min="0" max="10">
                </div>
                <div class="field">
                  <input type="text" name="valued" value="<%= row.valued_by %>" disabled>
                </div>
              </div>
            </div>
          </form>
        <% } if(currentUser.id == row.valued_by) { %>
          <button>edit</button>
          
          <button>delete</button>
          <form method='post' action="/marks/<%= result.pid %>?_method=DELETE">
            <input type="submit" class="btn btn-danger" value="delete">
          </form>
        <% } %>
      </td>
      <td><%= row["demonstration"] %></td>
      <td><%= row["viva"] %></td>
      <td><%= row["report"] %></td>
      <td><%= row["total"] %></td>
      <td><%= row["valued_by"] %></td>
  </tr>
  <% } %>
</table>
</div>







<script type="text/javascript" src="/public/main.js"></script>
<% include ../partials/footer %>